"0","# flag=1 の数をプロット"
"0","# flag が 1 の試行数を expID ごとに集計"
"0","ol_count <- dfRAW %>%"
"0","  dplyr::filter(outlier == 1) %>%"
"0","  group_by(subID, expID) %>%"
"0","  summarise(ol_count = n(), .groups = 'drop')"
"0",""
"0","# subID ごとの総数を計算し、多い順に並び替え"
"0","ol_count <- ol_count %>%"
"0","  group_by(subID) %>%"
"0","  summarise(total_count = sum(ol_count)) %>%"
"0","  arrange(desc(total_count)) %>%"
"0","  left_join(ol_count, by = ""subID"")"
"0",""
"0","# subID を総数が多い順に並び替える"
"0","ol_count <- ol_count %>%"
"0","  mutate(subID = factor(subID, levels = unique(subID)))"
"0",""
"0","# 参加者ごとに flag が 1 の試行数を棒グラフでプロット"
"0","plot_outlierCount <- ggplot(ol_count, aes(x = factor(subID), y = ol_count, fill = factor(expID))) +"
"0","  geom_bar(stat = ""identity"", color = ""black"", alpha = 0.7) +"
"0","    labs(x = ""Subject ID"","
"0","         y = ""Number of Outliered Trials"","
"0","         fill = ""Experiment"") +"
"0","    theme_apa() +"
"0","    theme("
"0","      legend.position = ""bottom"","
"0","      legend.direction = ""horizontal"""
"0","  )"
"0",""
"0","saveRDS(plot_outlierCount, file = here(""data/plot_outlierCount.rds""))"
"0","plot_outlierCount"
