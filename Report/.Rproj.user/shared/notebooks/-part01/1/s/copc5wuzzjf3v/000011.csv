"0","# flag=1 の数をプロット"
"0","# flag が 1 の試行数をsubID, expID ごとに集計"
"0","flag_count <- dfRAW %>%"
"0","  dplyr::filter(flag == 1) %>%"
"0","  group_by(subID, expID) %>%"
"0","  summarise(flag_count = n(), .groups = 'drop')"
"0",""
"0","# subID ごとの総数を計算し、多い順に並び替え"
"0","flag_count <- flag_count %>%"
"0","  group_by(subID) %>%"
"0","  summarise(total_count = sum(flag_count)) %>%"
"0","  arrange(desc(total_count)) %>%"
"0","  left_join(flag_count, by = ""subID"")"
"0",""
"0","# subID を総数が多い順に並び替える"
"0","flag_count <- flag_count %>%"
"0","  mutate(subID = factor(subID, levels = unique(subID)))"
"0",""
"0","# subID ごとに expID の積み上げ棒グラフを作成"
"0","plot_flagCount <- ggplot(flag_count, aes(x = factor(subID), y = flag_count, fill = expID)) +"
"0","  geom_bar(stat = ""identity"", color = ""black"", alpha = 0.7) +"
"0","  labs(x = ""Subject ID"","
"0","       y = ""Number of Flagged Trials"","
"0","       fill = ""Experiment"") +"
"0","  theme_apa() +"
"0","  theme("
"0","    legend.position = ""bottom"","
"0","    legend.direction = ""horizontal"""
"0","  )"
"0",""
"0","saveRDS(plot_flagCount, file = here(""data/plot_flagCount.rds""))"
"0","plot_flagCount"
